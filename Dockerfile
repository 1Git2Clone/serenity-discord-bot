################################################################################
# Set the base image for use
FROM rust:latest
################################################################################

################################################################################
# Set Offline SQLX handling (optional)
ENV SQLX_OFFLINE=true
################################################################################

################################################################################
# Set Rust environment variable (optional)
# ENV RUST_BACKTRACE=1
################################################################################

################################################################################
# The name is customizable. Just make sure it isn't just `/`
WORKDIR /app
################################################################################

################################################################################
# Copy all of the project files
################################################################################
COPY . .

################################################################################
# This makes the database volume that you're supposed to have from the README.md
################################################################################
### ```sh
### sudo docker volume create --name database
### ```
################################################################################
VOLUME [ "/database" ]

################################################################################
# Install dependencies
################################################################################
RUN cargo install --locked --path .

################################################################################
# Build the project in release mode
################################################################################
RUN cargo build --release

################################################################################
# Set the command to run the application
################################################################################
CMD ["cargo", "run", "--release"]
